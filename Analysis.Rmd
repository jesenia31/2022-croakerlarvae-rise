---
title: "Analysis"
output: html_notebook
---
```{r setup}
library(lubridate)
library(tidyverse)
library(ggplot2)
```

Pull file
```{r}
atlantic_croaker_final <- read_csv("data/atlantic_croaker_final.csv")
View(atlantic_croaker_final)
```

Make new columns to answer hypothesis
```{r}
atlantic_croaker_final <- atlantic_croaker_final %>% 
  mutate(aspect_ratio=(Caudheight/Caudarea)^(1/2), square_caudal_peduncle_depth_factor=(Cauddepth/Depthatpec)^2, 
         Year=year(Tow_date))
View(atlantic_croaker_final)
```

Structure
1. Type question
2. Make plot
3. Run statistical test
4. Answer question

Hypothesis:
Fish from 1995 will have a higher total length and aspect ratio, and a lower square caudal peduncle depth factor compared to fish from 2017. 

```{r}
#Make dataframe for 1995 & 2017 fish
##in order to create statistical tests
atcroaker95 <- atlantic_croaker_final %>% 
  filter(Year==1995)

atcroaker17 <- atlantic_croaker_final %>% 
  filter(Year==2017)
```

Question 1:
Is aspect ratio higher in fish from 1995 than fish from 2017?
```{r}
#Making a plot
ggplot(data= atlantic_croaker_final, aes(x=aspect_ratio)) +
  geom_histogram() +
  facet_wrap(~Year)

ggplot(data=atlantic_croaker_final) +
  geom_boxplot(aes(x=Year, y=aspect_ratio, group= Year))

#Statistical test
t.test(x=atcroaker95$aspect_ratio, y=atcroaker17$aspect_ratio, alternative = c("two.sided"))
```

Question 2:
Does fish from 1995 have a higher total length measurement than fish from 2017?
```{r}
#Make a plot
ggplot(data= atlantic_croaker_final, aes(x=Totallength)) +
  geom_histogram() +
  facet_wrap(~Year)

ggplot(data=atlantic_croaker_final) +
  geom_boxplot(aes(x=Year, y=Totallength, group= Year))

#Statistical analysis
t.test(x=atcroaker95$Totallength, y=atcroaker17$Totallength , alternative=c("two.sided"))
```

Question 3:
Is square caudal peduncle depth factor lower in fish from 1995 than fish from 2017?
```{r}
#Make a plot
ggplot(data= atlantic_croaker_final, aes(x=square_caudal_peduncle_depth_factor)) +
  geom_histogram() +
  facet_wrap(~Year)

ggplot(data=atlantic_croaker_final) +
  geom_boxplot(aes(x=Year, y=square_caudal_peduncle_depth_factor, group= Year))

#Statistical analysis
t.test(x=atcroaker95$square_caudal_peduncle_depth_factor,  y=atcroaker17$square_caudal_peduncle_depth_factor, alternative = c("two.sided"))
```

